/*
* Copyright 2014 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

var ribbonType = "", editRibbonPictureButtonElement = "", pageRibbonTableSelector = "table.page-ribbon"; $(document).ready(function () { addRibbonPicturesGrid(); $(pageRibbonTableSelector).each(function () { var a = $(this).find(".ribbon-image label"); void 0 != a && 0 < a.length && $(this).find(".remove-ribbon-picture").css("display", "none") }); $("tr.ribbon-picture-buttons .edit-ribbon-picture").click(function () { "" != getEditPictureUrl(this) && (editRibbonPictureButtonElement = this, $(editRibbonPictureButtonElement).parents(".page-ribbon-settings").each(function (a, b) { var c = $(b).attr("data-ribbontype"); void 0 != c && "" != c && (ribbonType = c) }), addAndDisplayRibbonPicturesGrid()) }); $("tr.ribbon-picture-buttons .remove-ribbon-picture").on("click", function () { var a = $(this).closest("table.page-ribbon").find("td.ribbon-image"); void 0 != a && void 0 != $(a).find("img") && (setRibbonType(this), removePictureId(), removeRibbonPictureFromDom(a), $(this).css("display", "none")) }); $(".manage-ribbon-pictures").click(function () { window.location.href = getAddDeleteProductRibbonPictureUrl(this) }); $("#ribbon-pictures-grid td img").livequery("click", function (a) { if (a = $(this).attr("alt")) { var b = $(this).attr("src"); addPictureIdToTheMarkup(a, b) } }) }); function setRibbonType(a) { $(a).parents(".page-ribbon-settings").each(function (a, c) { var d = $(c).attr("data-ribbontype"); void 0 != d && "" != d && (ribbonType = d) }) } function removeRibbonPictureFromDom(a) { var b = getNoPlictureLableText(); "" != b && (b = "<label>" + b + "</label>", $(a).html(b)) } function removePictureId() { "category" == ribbonType && void 0 != $("#CategoryPageRibbon_PictureId") && $("#CategoryPageRibbon_PictureId").attr("value", 0); "product" == ribbonType && void 0 != $("#ProductPageRibbon_PictureId") && $("#ProductPageRibbon_PictureId").attr("value", 0) } function addAndDisplayRibbonPicturesGrid() { var a = $(".ribbonPicturesWindow").data("kendoWindow"); void 0 == a && (populateWindowPictureGrid(), $(".ribbonPicturesWindow").kendoWindow({ width: 650, modal: !0, animation: !1 }), a = $(".ribbonPicturesWindow").data("kendoWindow")); a.center(); $(".ribbonPicturesWindow").closest(".k-window").css("top", "70px"); a.open() } function addRibbonPicturesGrid() { $("body").prepend('<div class="ribbonPicturesWindow"><div id="ribbon-pictures-grid"></div></div>') } function populateWindowPictureGrid() { var a = getSetRibbonPictureUrl(); "" != a && ($("#ribbon-pictures-grid").kendoGrid({ dataSource: new kendo.data.DataSource({ transport: { read: { url: a, dataType: "json", type: "POST" } }, schema: { data: "Data", total: "Total" }, pageSize: 10, serverPaging: !0 }), selectable: "single", pageable: !0, columns: [{ field: "Id", filterable: !1 }, { field: "PictureUrl", template: "<img src='${ PictureUrl }' alt='${ Id }' />", width: 250 }, { field: "PictureHeight", filterable: !0 }, { field: "PictureWidth", filterable: !0 }] }), $("#ribbon-pictures-grid").data("kendoGrid").hideColumn("Id")) } function addPictureIdToTheMarkup(a, b) { "category" == ribbonType && void 0 != $("#CategoryPageRibbon_PictureId") && setPictureId("#CategoryPageRibbon_PictureId", a, b); "product" == ribbonType && void 0 != $("#ProductPageRibbon_PictureId") && setPictureId("#ProductPageRibbon_PictureId", a, b) } function setPictureId(a, b, c) { $(a).attr("value", b); $(".ribbonPicturesWindow").data("kendoWindow").close(); addPictureToDom(c, b); showDeleteRibbonPictureButton() } function showDeleteRibbonPictureButton() { var a = $(editRibbonPictureButtonElement).closest("table.page-ribbon").find(".remove-ribbon-picture"); void 0 != a && $(a).css("display", "inline-block") } function addPictureToDom(a, b) { var c = $(editRibbonPictureButtonElement); void 0 != c && (c = c.closest("table.page-ribbon").find(".ribbon-image"), void 0 != c && c.html("<img src=" + a + " alt=" + b + " />")) } function getRibbonPictureId(a) { a = $(a).attr("data-ribbonPictureId"); return void 0 == a || "" == a ? 0 : parseInt(a) || 0 } function getSetRibbonPictureUrl() { var a = $("#ribbon-data").attr("data-setRibbonPictureUrl"); return void 0 == a ? "" : a } function getNoPlictureLableText() { var a = $("#ribbon-data").attr("data-noPictureLabelText"); return void 0 == a ? "" : a } function getAddDeleteProductRibbonPictureUrl(a) { a = $(a).attr("data-addDeleteProductRibbonPictureUrl"); return void 0 == a ? "" : a } function getEditPictureUrl(a) { a = $(a).attr("data-editPictureUrl"); return void 0 == a || "" == a ? "" : a };