/*
* Copyright 2014 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { $(".attributeFilterPanel7Spikes .filtersGroupPanel a[data-option-ids]").each(function () { var c = new AttributeFiltersManager; $(this).click(c.filterProductsByProductAttributeOption) }) }); function AttributeFiltersManager() { } AttributeFiltersManager.prototype.filterProductsByProductAttributeOption = FilterProductsByProductAttributeOption; AttributeFiltersManager.prototype.buildAttributeFiltersModel = BuildAttributeFiltersModel; AttributeFiltersManager.prototype.refreshAttributeFilters = RefreshAttributeFilters; FiltersManager.prototype.buildAttributeFiltersModel = (new AttributeFiltersManager).buildAttributeFiltersModel; FiltersManager.prototype.refreshAttributeFilters = (new AttributeFiltersManager).refreshAttributeFilters; function BuildAttributeFiltersModel(c, a, e, b) { var d = {}; d.CategoryId = c; d.ManufacturerId = a; d.VendorId = e; d.AttributeFilterGroups = []; $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (a, c) { var e = $(c).attr("data-optionsGroupId"), g = {}; g.Id = e; void 0 != b && b.get(0) == c && (g.IsMain = !0, d.Priority = 1); g.FilterItems = []; $(c).find("a[data-option-ids]").each(function (c, a) { var d = $(a).text(), d = $.trim(d), b = $(a).attr("data-option-ids"), e = $(a).attr("class"), k = {}, b = b.split(","); k.Name = d; k.ProductVariantAttributeIds = b; k.FilterItemState = (new FiltersManager).getFilterItemStateBasedOnItemClass(e, k.FilterItemState); g.FilterItems.push(k) }); d.AttributeFilterGroups.push(g) }); return d } function RefreshAttributeFilters(c, a) { $(".attributeFilterPanel7Spikes .filtersGroupPanel").each(function (e, b) { var d = $(b).attr("data-optionsGroupId"), f = $.grep(c.AttributeFilterGroups, function (a) { return a.Id == d }); if (0 != f.length) { var m = f[0]; if (a && "usedropdowns" == a) var l = !0; $(b).find("a[data-option-ids]").each(function (c, b) { var e = $(b).text(), f = $.trim(e), e = $(b).attr("class"), h = $.grep(m.FilterItems, function (a) { return a.Name == f }); 0 != h.length && (h = h[0], a && 1 == h.FilterItemState && "usedropdowns" == a && (l = !1, SetDropDownSelectedElementForAttributeFilters(d, b)), $(b).attr("class", (new FiltersManager).getFilterItemClassBasedOnState(h.FilterItemState, e))) }); a && "usedropdowns" == a && !0 == l && (f = $(b).find(".allFilterDropDownOptions")[0], SetDropDownSelectedElementForAttributeFilters(d, f)) } }) } function SetDropDownSelectedElementForAttributeFilters(c, a) { var e = $("#attributeFiltersDropDown" + c), b = $(a).parent(), d = e.get(0); b.siblings().removeClass("selected"); b.addClass("selected"); d.selectedLiElement = b; e.find("p").text($(a).text()) } function FilterProductsByProductAttributeOption(c) { c = $(c.currentTarget); var a = c.parents("div[data-optionsGroupId]"); (new FiltersManager).requestProductsForSelectedFilters(a, c) };